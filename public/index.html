<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>DHLab Newsletter Submission</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: monospace;
      background: #ffffff;
      color: #000000;
    }

body {
  display: flex;
  align-items: center;
  justify-content: center;
}

.box {
  width: fit-content;
  max-width: 92vw;
  margin: 0 auto;
  display: flex;
  flex-direction: column;   /* ← key fix */
  align-items: center;      /* keeps ascii centered */
}
    pre {
      margin: 0;
      font-family: monospace;
      line-height: 1.3;
    }
input, button {
  width: 100%;
  box-sizing: border-box;
}

    button {
      cursor: pointer;
    }

    #message {
      margin-top: 14px;
      min-height: 20px;
    }

    .spacer {
      height: 10px;
    }
.hint {
  font-size: 12px;
  margin-top: 2px;
  margin-bottom: 8px;
  opacity: 0.7;
}

.ascii {
  display: block;
  width: fit-content;
  margin: 0 auto 14px auto;
  text-align: left;
}

.footer-art {
  opacity: 0.75;
  margin-top: 10px;
}

  </style>
</head>
<body>
  <div class="box">

    <pre class="ascii">
                            
 ____  _   _ _         |-|      
|  _ \| | | | |    __ _| |  
| | | | |_| | |   / _` | '_ \
| |_| |  _  | |__| (_| | |_) |
|____/|_| |_|_____\__,_| .__/
                              
</pre>
<pre class="ascii"> 
+------------------------------------------------------------+
|               DHLab Newsletter Submission Form             |
+------------------------------------------------------------+

Came across some interesting calls, events, opportunities...?
Submit it here.

-------------------------------------------------------------

</pre>

    <div class="spacer"></div>

   <form id="entryForm">
  <label>Link</label>
  <input name="url" type="url" placeholder="https://example.com" required />
  <div class="hint">simply paste the relevant URL</div>

  <label>Date</label>
  <input name="date" type="date" required />
  <div class="hint">put in event date / submission date / deadline</div>

  <button type="submit">[ Submit ]</button>
</form>

    <div id="message"></div>

    <div class="spacer"></div>

<pre>
-------------------------------------------------------------
</pre>

[ updates sent daily at 09:00 if ≥7 new items, any deadline within 7 days, or no newsletter in 3 weeks ]

</div>
  </div>

  <script>
    const form = document.getElementById("entryForm");
    const message = document.getElementById("message");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      message.textContent = "...submitting";

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

            // Frontend past-date check
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      const picked = new Date(data.date);
      picked.setHours(0, 0, 0, 0);

      if (picked < today) {
        message.textContent = "✗ Date cannot be in the past.";
        return;
}


      try {
        const res = await fetch("/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        if (res.ok) {
          message.textContent = "✓ Submitted successfully.";
          form.reset();
        } else if (res.status === 409) {
          message.textContent = "! This link was already submitted.";
        } else {
          message.textContent = "✗ Error submitting.";
        }
      } catch (err) {
        message.textContent = "✗ Network error.";
      }
    });
  </script>
  <div class="box">


</body>
</html>
